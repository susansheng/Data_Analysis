# 📊 数据分析工具 - 用户行为漏斗分析

> 🔒 **100% 本地运行 · 数据不上传云端 · 完全离线可用**

基于用户行为漏斗（曝光→点击→转化→下单），精准计算核心指标，并通过拆解用户分层，输出可落地的业务洞察。

---

## 🎯 核心特性

- ✅ **完全本地化**: 所有数据处理均在本地完成，不上传任何服务器
- ✅ **零外部依赖**: HTML报告使用纯CSS实现，无需网络连接即可查看
- ✅ **数据隐私保护**: 您的敏感数据永远不会离开您的电脑
- ✅ **图形界面**: 双击启动，拖拽选择文件，无需命令行操作
- ✅ **易于使用**: 一键运行脚本，自动生成可视化报告
- ✅ **专业分析**: 多维度交叉分析，智能业务洞察

---

## 📦 文件说明

```
数据分析工具/
├── 启动分析工具.command          # 🖱️ 双击启动图形界面（最简单）
├── analyzer_gui.py              # 图形界面应用程序
├── run_analysis.sh              # 🚀 命令行一键运行脚本
├── funnel_analyzer.py           # 命令行分析工具（生成MD报告）
├── generate_offline_report.py   # 离线HTML报告生成器
└── README.md                    # 本文档
```

---

## 🚀 快速开始

### 方式1: 图形界面（最简单，推荐）

**双击打开** `启动分析工具.command` 文件

然后：
1. 📁 点击"选择文件"按钮，选择您的数据文件
2. ⚙️ 调整参数（可选）
3. ✅ 勾选要生成的报告类型
4. 🚀 点击"生成分析报告"按钮
5. 🎉 报告生成后会自动打开

**就这么简单！无需任何命令行操作！**

### 方式2: 命令行一键运行

```bash
cd /Users/sxsheng/Documents/代码/数据分析工具
./run_analysis.sh 你的数据文件.xlsx
```

自动生成两份报告：
- ✅ HTML可视化报告（推荐）
- ✅ Markdown文本报告

### 方式3: 手动运行

#### 生成可视化HTML报告
```bash
python3 generate_offline_report.py 数据文件.xlsx 输出文件.html
```

#### 生成Markdown文本报告
```bash
python3 funnel_analyzer.py 数据文件.xlsx -o 输出文件.md
```

---

## 📊 数据格式要求

您的数据文件（Excel或CSV）需要包含以下字段：

| 必需字段 | 说明 |
|---------|-----|
| `页面UV(SUM)` | 曝光人数 |
| `点击UV(SUM)` | 点击人数 |
| `点击用户提交单(SUM)` | 转化人数（提交订单） |
| `点击用户预订单(SUM)` | 下单人数（预订单） |
| `点击事件名称` | 模块名称 |
| `日期` | 日期（可选，用于趋势分析） |

**支持的文件格式**: `.xlsx`, `.xls`, `.csv`

---

## 📈 报告内容

### HTML可视化报告包含：

1. **📋 核心指标卡片**
   - 点击率 (CTR)
   - 点击转化率 (Click CVR)
   - 下单转化率 (Order CVR)
   - 分析周期

2. **📈 趋势分析图**
   - 最近15天核心指标变化趋势
   - 纯CSS实现，无需JavaScript

3. **🏆 Top 10模块对比**
   - 可视化条形图对比
   - 三大指标（CTR、转化率、下单率）

4. **🎯 Top 50榜单表格**
   - 按点击率降序排列
   - 彩色标签标注表现等级
   - 支持表格滚动查看

5. **💡 业务洞察与建议**
   - 漏斗流失分析
   - 针对性优化建议
   - 高价值模块推荐

---

## 🔧 高级选项

### 调整点击量阈值

默认会过滤掉点击量 < 10 的数据。您可以自定义阈值：

```bash
python3 funnel_analyzer.py 数据.xlsx --min-click 20
```

### 批量分析多个文件

```bash
for file in *.xlsx; do
    ./run_analysis.sh "$file"
done
```

---

## 🔒 隐私保护说明

### ✅ 本工具完全本地化

- **数据处理**: 100% 在您的电脑上完成
- **HTML报告**: 所有数据嵌入在HTML文件中，不访问任何外部服务器
- **可视化**: 使用纯CSS实现，无JavaScript，无外部库依赖
- **离线可用**: 可在完全断网的环境下运行和查看报告

### ⚠️ 关于Claude Code的说明

**如果您使用Claude Code（AI助手）来生成这个工具：**
- 在对话过程中，您分享的数据会被发送到Anthropic的API进行处理
- 这是AI助手理解您需求的必要过程

**但是，一旦工具生成完毕：**
- ✅ 您可以完全独立运行这些脚本
- ✅ 不再需要任何AI服务
- ✅ 所有数据都在本地处理

### 💡 保护敏感数据的建议

如果您的数据高度敏感：

1. **使用这个工具**: 它已经是完全本地化的
2. **数据脱敏**: 在分析前替换真实客户名、金额等
3. **断网运行**: 关闭WiFi后运行脚本，确保100%隔离

---

## 📋 核心指标计算公式

所有指标严格按照以下公式计算，并统一保留2位小数：

1. **模块点击率 (CTR)** = `(点击人数 / 曝光人数) × 100%`
2. **点击转化率 (Click CVR)** = `(转化人数 / 点击人数) × 100%`
3. **下单转化率 (Order CVR)** = `(下单人数 / 点击人数) × 100%`

---

## 🛠️ 系统要求

- **操作系统**: macOS / Linux / Windows
- **Python**: 3.7+
- **依赖库**:
  - `pandas` - 数据处理
  - `openpyxl` - 读取Excel文件

### 安装依赖

如果提示缺少库，运行：

```bash
pip3 install pandas openpyxl
```

---

## ❓ 常见问题

### Q: 报告可以分享给同事吗？
A: 可以！HTML报告是完全自包含的，直接发送HTML文件即可。同事无需安装任何软件，用浏览器打开即可查看。

### Q: 可以在没有网络的环境下使用吗？
A: 完全可以！所有功能都不依赖网络连接。

### Q: 支持哪些数据格式？
A: 支持 `.xlsx`, `.xls`, `.csv` 格式。

### Q: 如何处理大型数据集？
A: 工具已经内置了数据清洗逻辑，会自动过滤长尾噪音数据。如果数据量特别大（>100万行），建议先在Excel中筛选关键数据。

### Q: 数据真的不会上传吗？
A: 是的！您可以：
1. 断开网络后运行脚本
2. 检查脚本源代码（全部开源）
3. 使用网络监控工具验证没有任何外部请求

---

## 📞 技术支持

如有问题或建议，请检查：

1. **Python版本**: 确保是 Python 3.7+
2. **依赖库**: 确保已安装 `pandas` 和 `openpyxl`
3. **数据格式**: 确保Excel文件包含必需的字段
4. **文件路径**: 确保数据文件路径正确

---

## 📄 许可证

本工具为个人使用而创建，代码完全开源。您可以自由修改和分发。

---

## 🎉 开始使用

```bash
cd /Users/sxsheng/Documents/代码/数据分析工具
./run_analysis.sh 你的数据.xlsx
```

**祝分析愉快！** 📊✨

---

*🔒 100% 本地运行 · 保护您的数据隐私*
